let IcaoCallsigns = [
    {icaoc: "AAL",	calls: "American",	contry: "USA"},
    {icaoc: "AAR",	calls: "Asiana",	contry: "Republic of Korea"},
    {icaoc: "ABD",	calls: "Atlanta",	contry: "Iceland"},
    {icaoc: "ABP",	calls: "B-air",	contry: "Czechia"},
    {icaoc: "ABR",	calls: "Contract",	contry: "Ireland"},
    {icaoc: "ABW",	calls: "AirBridge Cargo",	contry: "Russian Federation"},
    {icaoc: "ABY",	calls: "Arabia",	contry: "UAE"},
    {icaoc: "ACA",	calls: "Air Canada",	contry: "Canada"},
    {icaoc: "ACP",	calls: "Astral Cargo",	contry: "Kenya"},
    {icaoc: "ADB",	calls: "Antonov Bureau",	contry: "Ukraine"},
    {icaoc: "AEA",	calls: "Europa",	contry: "Spain"},
    {icaoc: "AEE",	calls: "Aegean",	contry: "Greece"},
    {icaoc: "AEG",	calls: "Airest Cargo",	contry: "Estonia"},
    {icaoc: "AFL",	calls: "Aeroflot",	contry: "Russian Federation"},
    {icaoc: "AFR",	calls: "Airfrans",	contry: "France"},
    {icaoc: "AHO",	calls: "Air Hamburg",	contry: "Germany"},
    {icaoc: "AHY",	calls: "Azal",	contry: "Azerbaijan"},
    {icaoc: "AIC",	calls: "Air India",	contry: "India"},
    {icaoc: "AIZ",	calls: "Arkia",	contry: "Israel"},
    {icaoc: "ALK",	calls: "Srilankan",	contry: "Sri Lanka"},
    {icaoc: "AMC",	calls: "Air Malta",	contry: "Malta"},
    {icaoc: "ANA",	calls: "All Nippon",	contry: "Japan"},
    {icaoc: "ANE",	calls: "Nostru Air",	contry: "Spain"},
    {icaoc: "AOJ",	calls: "Asterix",	contry: "Austria"},
    {icaoc: "ART",	calls: "Smart Lynx",	contry: "Latvia"},
    {icaoc: "ASL",	calls: "Air Serbia",	contry: "Serbia"},
    {icaoc: "ATG",	calls: "Moldcargo",	contry: "Moldova"},
    {icaoc: "AUA",	calls: "Austrian",	contry: "Austria"},
    {icaoc: "AUI",	calls: "Ukraine International",	contry: "Ukraine"},
    {icaoc: "AWC",	calls: "Zap",	contry: "UK"},
    {icaoc: "AYY",	calls: "Lupus",	contry: "Germany"},
    {icaoc: "AZG",	calls: "Silk West",	contry: "Azerbaijan"},
    {icaoc: "AZQ",	calls: "Silk Line",	contry: "Azerbaijan"},
    {icaoc: "BAV",	calls: "Bamboo",	contry: "Vietnam"},
    {icaoc: "BAW",	calls: "Speedbird",	contry: "UK"},
    {icaoc: "BBC",	calls: "Bangladesh",	contry: "Bangladesh"},
    {icaoc: "BBD",	calls: "Blue Cargo",	contry: "Iceland"},
    {icaoc: "BBG",	calls: "Bluebird",	contry: "Greece"},
    {icaoc: "BCS",	calls: "Postman",	contry: "Germany"},
    {icaoc: "BEL",	calls: "Beeline",	contry: "Belgium"},
    {icaoc: "BGH",	calls: "Balkan Holidays",	contry: "Bulgaria"},
    {icaoc: "BLA",	calls: "Blue Air",	contry: "Romania"},
    {icaoc: "BLX",	calls: "Bluescan",	contry: "Sweden"},
    {icaoc: "BOH",	calls: "Bohemia",	contry: "Czechia"},
    {icaoc: "BOX",	calls: "German Cargo",	contry: "Germany"},
    {icaoc: "BPS",	calls: "Base",	contry: "Hungary"},
    {icaoc: "BRU",	calls: "Belavia",	contry: "Belarus"},
    {icaoc: "BTI",	calls: "Airbaltic",	contry: "Latvia"},
    {icaoc: "BUC",	calls: "Eurocharter",	contry: "Bulgaria"},
    {icaoc: "BUR",	calls: "Air Bucharest",	contry: "Romania"},
    {icaoc: "CAI",	calls: "Corendon",	contry: "Turkey"},
    {icaoc: "CAL",	calls: "Dynasty",	contry: "Taiwan"},
    {icaoc: "CCA",	calls: "Air China",	contry: "China"},
    {icaoc: "CEF",	calls: "Czech Air Force",	contry: "Czechia"},
    {icaoc: "CES",	calls: "China Eastern",	contry: "China"},
    {icaoc: "CFG",	calls: "Condor",	contry: "Germany"},
    {icaoc: "CGF",	calls: "Clever",	contry: "Bulgaria"},
    {icaoc: "CHH",	calls: "Hainan",	contry: "China"},
    {icaoc: "CKS",	calls: "Connie",	contry: "USA"},
    {icaoc: "CLX",	calls: "Cargolux",	contry: "Luxembourg"},
    {icaoc: "CMB",	calls: "Camber",	contry: "USA"},
    {icaoc: "CND",	calls: "Dutch Corendon",	contry: "Netherlands"},
    {icaoc: "CNV",	calls: "Convoy",	contry: "USA"},
    {icaoc: "CTN",	calls: "Croatia",	contry: "Croatia"},
    {icaoc: "CVK",	calls: "Cargo Line",	contry: "Ukraine"},
    {icaoc: "CXI",	calls: "Touristic",	contry: "Malta"},
    {icaoc: "CYP",	calls: "Cyprus",	contry: "Cyprus"},
    {icaoc: "CSA",	calls: "CSA",	contry: "Czechia"},
    {icaoc: "CSH",	calls: "Shanghai Air",	contry: "China"},
    {icaoc: "DAH",	calls: "Air Algerie",	contry: "Algeria"},
    {icaoc: "DAL",	calls: "Delta",	contry: "USA"},
    {icaoc: "DCS",	calls: "Twin Star",	contry: "Germany"},
    {icaoc: "DHK",	calls: "World Express",	contry: "UK"},
    {icaoc: "DLA",	calls: "Dolomiti",	contry: "Italy"},
    {icaoc: "DLH",	calls: "Lufthansa",	contry: "Germany"},
    {icaoc: "DTR",	calls: "Danish",	contry: "Denmark"},
    {icaoc: "EDW",	calls: "Edelweiss",	contry: "Switzerland"},
    {icaoc: "EIN",	calls: "Shamrock",	contry: "Ireland"},
    {icaoc: "EJU",	calls: "Alpine",	contry: "Austria"},
    {icaoc: "ELJ",	calls: "Topjet",	contry: "Slovakia"},
    {icaoc: "ELY",	calls: "El Al",	contry: "Israel"},
    {icaoc: "ENT",	calls: "Enterair",	contry: "Poland"},
    {icaoc: "ETD",	calls: "Etihad",	contry: "UAE"},
    {icaoc: "ETH",	calls: "Ethiopian",	contry: "Ethiopia"},
    {icaoc: "EVA",	calls: "Eva",	contry: "Taiwan"},
    {icaoc: "EWG",	calls: "Eurowings",	contry: "Germany"},
    {icaoc: "EXS",	calls: "Channex",	contry: "UK"},
    {icaoc: "EZY",	calls: "Easy",	contry: "UK"},
    {icaoc: "EZS",	calls: "Topswiss",	contry: "Switzerland"},
    {icaoc: "FAH",	calls: "Blue Strip",	contry: "Hungary"},
    {icaoc: "FCA",	calls: "Coopair",	contry: "Hungary"},
    {icaoc: "FDB",	calls: "Sky Dubai",	contry: "UAE"},
    {icaoc: "FDX",	calls: "Fedex",	contry: "USA"},
    {icaoc: "FEG",	calls: "Sky Egypt",	contry: "Egypt"},
    {icaoc: "FHY",	calls: "Freebird air",	contry: "Turkey"},
    {icaoc: "FIA",	calls: "Fia",	contry: "Moldova"},
    {icaoc: "FIN",	calls: "Finnair",	contry: "Finland"},
    {icaoc: "FLI",	calls: "Faroeline",	contry: "Faroe Islands"},
    {icaoc: "FOR",	calls: "Formula",	contry: "UK"},
    {icaoc: "FPO",	calls: "French Post",	contry: "France"},
    {icaoc: "FRF",	calls: "Fairfleet",	contry: "Hungary"},
    {icaoc: "FTL",	calls: "Flight-avia",	contry: "Spain"},
    {icaoc: "FTY",	calls: "Fly Tyrol",	contry: "Austria"},
    {icaoc: "GAC",	calls: "Dream Team",	contry: "Austria"},
    {icaoc: "GAF",	calls: "German Air Force",	contry: "Germany"},
    {icaoc: "GEC",	calls: "Lufthansa Cargo",	contry: "Germany"},
    {icaoc: "GFA",	calls: "Gulf Air",	contry: "Bahrain"},
    {icaoc: "GIA",	calls: "Indonesia",	contry: "Indonesia"},
    {icaoc: "GTI",	calls: "Giant",	contry: "USA"},
    {icaoc: "HES",	calls: "Holiday Europe",	contry: "Bulgaria"},
    {icaoc: "HFY",	calls: "Sky Flyer",	contry: "Portugal"},
    {icaoc: "HKH",	calls: "Hawkhungary",	contry: "Hungary"},
    {icaoc: "HKY",	calls: "Herky",	contry: "USA"},
    {icaoc: "HUAF",	calls: "Hungarian Airforce",	contry: "Hungary"},
    {icaoc: "HVN",	calls: "Vietnam",	contry: "Vietnam"},
    {icaoc: "HYP",	calls: "Hyperion",	contry: "Malta"},
    {icaoc: "IAW",	calls: "Iraqi",	contry: "Iraq"},
    {icaoc: "IBE",	calls: "Iberia",	contry: "Spain"},
    {icaoc: "ICL",	calls: "Cal",	contry: "Israel"},
    {icaoc: "ICV",	calls: "Cargolux Italia",	contry: "Italy"},
    {icaoc: "IFA",	calls: "Red Angel",	contry: "Germany"},
    {icaoc: "IJM",	calls: "Jet Management",	contry: "Austria"},
    {icaoc: "IRA",	calls: "Iranair",	contry: "Iran"},
    {icaoc: "IRM",	calls: "Mahan Air",	contry: "Iran"},
    {icaoc: "ISR",	calls: "Israir",	contry: "Israel"},
    {icaoc: "ITE",	calls: "Aerotaxi",	contry: "Czechia"},
    {icaoc: "JAF",	calls: "Beauty",	contry: "Belgium"},
    {icaoc: "JAL",	calls: "Japanair",	contry: "Japan"},
    {icaoc: "JAR",	calls: "Airlink",	contry: "Austria"},
    {icaoc: "JDI",	calls: "Jedi",	contry: "Poland"},
    {icaoc: "JEI",	calls: "Jet Executive",	contry: "Germany"},
    {icaoc: "JSH",	calls: "Stream Air",	contry: "Hungary"},
    {icaoc: "JTD",	calls: "Jettime",	contry: "Denmark"},
    {icaoc: "KAC",	calls: "Kuwaiti",	contry: "Kuwait"},
    {icaoc: "KAL",	calls: "Koreanair",	contry: "Republic of Korea"},
    {icaoc: "KLM",	calls: "KLM",	contry: "Netherlands"},
    {icaoc: "KRP",	calls: "Carpatair",	contry: "Romania"},
    {icaoc: "KQA",	calls: "Kenya",	contry: "Kenya"},
    {icaoc: "LBT",	calls: "Nouvelair",	contry: "Tunisia"},
    {icaoc: "LDX",	calls: "Lauda Rush",	contry: "Austria"},
    {icaoc: "LGL",	calls: "Luxair",	contry: "Luxembourg"},
    {icaoc: "LMU",	calls: "Almasria",	contry: "Egypt"},
    {icaoc: "LOT",	calls: "Lot",	contry: "Poland"},
    {icaoc: "LZB",	calls: "Flying Bulgaria",	contry: "Bulgaria"},
    {icaoc: "MAC",	calls: "Arabia Maroc",	contry: "Morocco"},
    {icaoc: "MAE",	calls: "Mali Airexpress",	contry: "Austria"},
    {icaoc: "MAS",	calls: "Malaysian",	contry: "Malaysia"},
    {icaoc: "MEA",	calls: "Cedar Jet",	contry: "Lebanon"},
    {icaoc: "MHV",	calls: "Snowcap",	contry: "Germany"},
    {icaoc: "MLD",	calls: "Air Moldova",	contry: "Moldova"},
    {icaoc: "MMZ",	calls: "Euroatlantic",	contry: "Portugal"},
    {icaoc: "MNB",	calls: "Black Sea",	contry: "Turkey"},
    {icaoc: "MPH",	calls: "Martinair",	contry: "Netherlands"},
    {icaoc: "MSC",	calls: "Air Cairo",	contry: "Egypt"},
    {icaoc: "MSR",	calls: "Egyptair",	contry: "Egypt"},
    {icaoc: "MSX",	calls: "Egyptair Cargo",	contry: "Egypt"},
    {icaoc: "MTL",	calls: "Mitavia",	contry: "Latvia"},
    {icaoc: "MYX",	calls: "Tallinn Cat",	contry: "Estonia"},
    {icaoc: "NCR",	calls: "National Cargo",	contry: "USA"},
    {icaoc: "NJE",	calls: "Fraction",	contry: "Portugal"},
    {icaoc: "NPT",	calls: "Neptune",	contry: "UK"},
    {icaoc: "NOS",	calls: "Moonflower",	contry: "Italy"},
    {icaoc: "NOZ",	calls: "Nordic",	contry: "Norway"},
    {icaoc: "NSZ",	calls: "Rednose",	contry: "Norway"},
    {icaoc: "NTF",	calls: "Netflight",	contry: "Czechia"},
    {icaoc: "NVD",	calls: "Nordvind",	contry: "Lithuania"},
    {icaoc: "NVR",	calls: "Navigator",	contry: "Sweden"},
    {icaoc: "OAE",	calls: "Omni-Express",	contry: "USA"},
    {icaoc: "OAW",	calls: "Helvetic",	contry: "Switzerland"},
    {icaoc: "OCN",	calls: "Ocean",	contry: "Germany"},
    {icaoc: "OMA",	calls: "Oman Air",	contry: "Oman"},
    {icaoc: "ORF",	calls: "Oman",	contry: "Oman"},
    {icaoc: "OSY",	calls: "Open Skies",	contry: "USA"},
    {icaoc: "PAC",	calls: "Polar",	contry: "USA"},
    {icaoc: "PBD",	calls: "Pobeda",	contry: "Russian Federation"},
    {icaoc: "PGT",	calls: "Sunturk",	contry: "Turkey"},
    {icaoc: "PIA",	calls: "Pakistan",	contry: "Pakistan"},
    {icaoc: "PLF",	calls: "Polish Air Force",	contry: "Poland"},
    {icaoc: "PNC",	calls: "Prince Aviation",	contry: "Serbia"},
    {icaoc: "PNK",	calls: "Air Pink",	contry: "Serbia"},
    {icaoc: "PWF",	calls: "Private Wings",	contry: "Germany"},
    {icaoc: "QAF",	calls: "Amiri",	contry: "Qatar"},
    {icaoc: "QAJ",	calls: "Dagobert",	contry: "Germany"},
    {icaoc: "QFA",	calls: "Qantas",	contry: "Australi"},
    {icaoc: "QID",	calls: "Quid",	contry: "USA"},
    {icaoc: "QTR",	calls: "Qatari",	contry: "Qatar"},
    {icaoc: "RAM",	calls: "Royalair Maroc",	contry: "Morocco"},
    {icaoc: "RBA",	calls: "Brunei",	contry: "Brunei"},
    {icaoc: "RBG",	calls: "Arabia Egypt",	contry: "Egypt"},
    {icaoc: "RCH",	calls: "Reach",	contry: "USA"},
    {icaoc: "RJA",	calls: "Jordanian",	contry: "Jordan"},
    {icaoc: "ROF",	calls: "Romanian Air Force",	contry: "Romania"},
    {icaoc: "ROT",	calls: "Tarom",	contry: "Romania"},
    {icaoc: "ROU",	calls: "Rouge",	contry: "Canada"},
    {icaoc: "RRR",	calls: "Ascot",	contry: "UK"},
    {icaoc: "RUK",	calls: "Blue Max",	contry: "UK"},
    {icaoc: "RUN",	calls: "Cargo Turk",	contry: "Turkey"},
    {icaoc: "RYR",	calls: "Ryanair",	contry: "Ireland"},
    {icaoc: "RYS",	calls: "Magic Sun",	contry: "Poland"},
    {icaoc: "SAS",	calls: "Scandinavian",	contry: "Sweden"},
    {icaoc: "SAY",	calls: "Sky Path",	contry: "Russian Federation"},
    {icaoc: "SAZ",	calls: "Swiss Ambulance",	contry: "Switzerland"},
    {icaoc: "SBI",	calls: "Siberia",	contry: "Russian Federation"},
    {icaoc: "SDM",	calls: "Rossiya",	contry: "Russian Federation"},
    {icaoc: "SDR",	calls: "Sundair",	contry: "Germany"},
    {icaoc: "SHJ",	calls: "Sharjah",	contry: "UAE"},
    {icaoc: "SIA",	calls: "Singapore",	contry: "Singapore"},
    {icaoc: "SOO",	calls: "Southern Air",	contry: "USA"},
    {icaoc: "SOP",	calls: "Solinair",	contry: "Slovenia"},
    {icaoc: "SQC",	calls: "Singcargo",	contry: "Singapore"},
    {icaoc: "SQP",	calls: "Skyup",	contry: "Ukraine"},
    {icaoc: "SSG",	calls: "Slovak Government",	contry: "Slovakia"},
    {icaoc: "SUS",	calls: "Sunscan",	contry: "Denmark"},
    {icaoc: "SVA",	calls: "Saudia",	contry: "Saudi Arabia"},
    {icaoc: "SVR",	calls: "Sverdlovsk",	contry: "Russian Federation"},
    {icaoc: "SVW",	calls: "Silver Arrow",	contry: "Luxembourg"},
    {icaoc: "SWR",	calls: "Swiss",	contry: "Switzerland"},
    {icaoc: "SWT",	calls: "Swiftair",	contry: "Spain"},
    {icaoc: "SXS",	calls: "Sunexpress",	contry: "Turkey"},
    {icaoc: "TAP",	calls: "Air Portugal",	contry: "Portugal"},
    {icaoc: "TAR",	calls: "Tunair",	contry: "Tunisia"},
    {icaoc: "TAY",	calls: "Quality",	contry: "Belgium"},
    {icaoc: "TDR",	calls: "Tradeair",	contry: "Croatia"},
    {icaoc: "TFL",	calls: "Orange",	contry: "Netherlands"},
    {icaoc: "TGZ",	calls: "Tamazi",	contry: "Georgia"},
    {icaoc: "THA",	calls: "Thai",	contry: "Thailand"},
    {icaoc: "THY",	calls: "Turkish",	contry: "Turkey"},
    {icaoc: "TIE",	calls: "Time Air",	contry: "Czechia"},
    {icaoc: "TIH",	calls: "Tiriac Air",	contry: "Romania"},
    {icaoc: "TJS",	calls: "Tyroljet",	contry: "Austria"},
    {icaoc: "TOM",	calls: "Tomjet",	contry: "UK"},
    {icaoc: "TRA",	calls: "Transavia",	contry: "Netherlands"},
    {icaoc: "TRK",	calls: "Turkish Republic",	contry: "Turkey"},
    {icaoc: "TTJ",	calls: "Tatra",	contry: "Slovakia"},
    {icaoc: "TUA",	calls: "Turkmenistan",	contry: "Turkmenistan"},
    {icaoc: "TUI",	calls: "Tuijet",	contry: "Germany"},
    {icaoc: "TVF",	calls: "France Soleil",	contry: "France"},
    {icaoc: "TVL",	calls: "Travel Service",	contry: "Hungary"},
    {icaoc: "TVP",	calls: "Jet Travel",	contry: "Poland"},
    {icaoc: "TVQ",	calls: "Slovaktravel",	contry: "Slovakia"},
    {icaoc: "TVS",	calls: "Skytravel",	contry: "Czechia"},
    {icaoc: "TWG",	calls: "Twin-Goose",	contry: "Germany"},
    {icaoc: "TWI",	calls: "Tailwind",	contry: "Turkey"},
    {icaoc: "TYA",	calls: "Taimyr",	contry: "Russian Federation"},
    {icaoc: "TYW",	calls: "Tyrol Ambulance",	contry: "Austria"},
    {icaoc: "UAE",	calls: "Emirates",	contry: "UAE"},
    {icaoc: "UAL",	calls: "United",	contry: "USA"},
    {icaoc: "UNO",	calls: "United Nations",	contry: "n/a"},
    {icaoc: "UPS",	calls: "UPS",	contry: "USA"},
    {icaoc: "VDA",	calls: "Volga",	contry: "Russian Federation"},
    {icaoc: "VIR",	calls: "Virgin",	contry: "UK"},
    {icaoc: "VJT",	calls: "Vista Jet",	contry: "Malta"},
    {icaoc: "VKG",	calls: "Viking",	contry: "Denmark"},
    {icaoc: "VLG",	calls: "Vueling",	contry: "Spain"},
    {icaoc: "VMP",	calls: "Vampire",	contry: "Denmark"},
    {icaoc: "VOE",	calls: "Volotea",	contry: "Spain"},
    {icaoc: "VTB",	calls: "Suxair",	contry: "Hungary"},
    {icaoc: "WRC",	calls: "Wind Rose",	contry: "Ukraine"},
    {icaoc: "WUK",	calls: "Wizz Go",	contry: "UK"},
    {icaoc: "WZZ",	calls: "Wizz Air",	contry: "Hungary"}
];

document.addEventListener('keydown', function (event) {
    if (event.key === 'Enter'){
        showNext();
    }
});

const dropdownInput = document.querySelector('.dropdown-input');
const dropdownList = document.getElementById('dropdownList');
const arrowdown = document.getElementById('dropdownarrow');
const IcaoHint = document.getElementById("IcaoHint");
const CallsignHint = document.getElementById("CallsignHint");
const CoutryHint = document.getElementById("CoutryHint");
const score = document.getElementById("score");
const errorstxt = document.getElementById("txt");
let errors = 0;
let ErrorList = [];
ShuffledCallsigns = [];
let countryName = '';

// Function to handle the filtering and shuffling of the IcaoCallsigns array
function filterAndShuffle() {
    // Get the selector input values
    const selectorFrom = parseInt(document.getElementById("selectFrom").value) - 1; // Convert to zero-based index
    const selectorTo = parseInt(document.getElementById("selectTo").value);

    // Validate the input values
    if (isNaN(selectorFrom) || isNaN(selectorTo) || selectorFrom < 0 || selectorTo > IcaoCallsigns.length || selectorFrom >= selectorTo) {
        alert("Invalid selection range.");
        return;
    }

    // Filter the IcaoCallsigns array based on the selector inputs
    let filteredCallsigns = IcaoCallsigns.slice(selectorFrom, selectorTo);

    // Shuffle the filtered list
    ShuffledCallsigns = shuffle(filteredCallsigns);
    currentCallsignIndex = 0;
    nextCallsignIndex = 1;
    errors = 0;
    errorstxt.innerHTML = errors;
    clear();

    // Output the shuffled list (or you can use it further as needed)
    console.log(ShuffledCallsigns);
    showCalls();
}

// Example shuffle function (already present in your code)
function shuffle(array) {
    for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
    }
    return array;
}

// Attach the filterAndShuffle function to the 'blur' event on the selectTo input field
document.getElementById("selectTo").addEventListener("blur", filterAndShuffle);

// Megjeleníti a lenyíló menüt, ha az inputra kattintunk
dropdownInput.addEventListener('focus', () => {
    dropdownList.style.display = 'block';
});

arrowdown.addEventListener('click', () => {
    if (dropdownList.style.display === 'block') {
        dropdownList.style.display = 'none';
    } else {
        dropdownList.style.display = 'block';
    }
});

// Elrejti a lenyíló menüt, ha a felhasználó máshová kattint
document.addEventListener('click', (e) => {
    if (!e.target.closest('.dropdown')) {
        dropdownList.style.display = 'none';
    }
});

// Opció kiválasztása
function selectOption(element) {
    countryName = element.querySelector('.country-name').textContent;
    dropdownInput.value = countryName;
    dropdownList.style.display = 'none';
}


// Opciók szűrése az input mező alapján
function filterOptions() {
    const filter = dropdownInput.value.toLowerCase();
    const options = dropdownList.getElementsByClassName('dropdown-item');

    for (let i = 0; i < options.length; i++) {
        const option = options[i];
        const countryName = option.querySelector('.country-name').textContent.toLowerCase();
        
        // Szűrés csak a filter-rel kezdődő országokra
        if (countryName.startsWith(filter)) {
            option.style.display = "";
        } else {
            option.style.display = "none";
        }
    }
}


document.addEventListener("DOMContentLoaded", function() {
    if (ShuffledCallsigns.length > 0) {
        showCalls();  // Ensure the shuffled list is used from the start
    } else {
        ShuffledCallsigns = shuffle(IcaoCallsigns.slice()); // Create a copy and shuffle
        console.log("No range selected. Using all ICAO callsigns shuffled.");
        showCalls();
    }
});

let currentCallsignIndex = 0;
let nextCallsignIndex = currentCallsignIndex + 1;
let mode = "basic";

var headerContent = document.getElementById("header");
var IcaoField = document.getElementById("IcaoField");
var CallsignField = document.getElementById("CallsignField");

function switchmodes(){
    if(mode === "basic"){
        mode = "second";
        IcaoField.style.display = "flex";
        CallsignField.style.display = "none";
    }
    else{
        mode = "basic";
        IcaoField.style.display = "none";
        CallsignField.style.display = "flex";
    }
    showCalls()
}

function showCalls(){
    const currentCallsign = ShuffledCallsigns[currentCallsignIndex];
    score.innerHTML = (nextCallsignIndex + "/" + ShuffledCallsigns.length);
    errorstxt.innerHTML = errors;

    if(mode === "basic"){
        headerContent.innerHTML = currentCallsign.icaoc;
    }
    else{
        headerContent.innerHTML = currentCallsign.calls;
    }
}

function showNext() {
    if (check()) {
        if (ShuffledCallsigns.length > currentCallsignIndex + 1) {
            currentCallsignIndex += 1;
            nextCallsignIndex += 1;
            showCalls();
            clear();
            if (checkCountry()) {
                CallsignHint.innerHTML = "";
            } else {
                previousHint();
                CoutryHint.style.backgroundColor = "red";
            }
        } else {
            if (checkCountry()) {
                previousHint();
                CoutryHint.style.backgroundColor = "red";
                done();
            } else {
                done();
                clear();
            }
        }
    } else {
        errors += 1;
        ErrorList.push(ShuffledCallsigns[currentCallsignIndex].icaoc + " - " + ShuffledCallsigns[currentCallsignIndex].calls + " - " + ShuffledCallsigns[currentCallsignIndex].contry);
        errorstxt.innerHTML = errors;

        errorstxt.style.color = "red"; // Pirosra állítjuk
        setTimeout(() => {
            errorstxt.style.color = "black"; // Majd visszaállítjuk feketére
        }, 330); // 500 ms múlva vált vissza feketére
        setTimeout(() => {
            errorstxt.style.color = "red";
        }, 660);
        setTimeout(() => {
            errorstxt.style.color = "black";
        }, 1000);

    }
}

function clear(){
    document.getElementById("Callsign").value = "";
    document.getElementById("ICAOcode").value = "";
    document.querySelector(".dropdown-input").value = "";
    CoutryHint.style.backgroundColor = "white";
    IcaoHint.innerHTML = "";
    CoutryHint.innerHTML = "";
    CallsignHint.innerHTML = "";

    const options = dropdownList.getElementsByClassName('dropdown-item');
    for (let i = 0; i < options.length; i++) {
        options[i].style.display = "";
    }
}

function previousHint(){
    IcaoHint.innerHTML = ShuffledCallsigns[currentCallsignIndex - 1].icaoc;
    CallsignHint.innerHTML = ShuffledCallsigns[currentCallsignIndex - 1].calls;
    CoutryHint.innerHTML = ShuffledCallsigns[currentCallsignIndex - 1].contry;
}

function hint(){
    IcaoHint.innerHTML = ShuffledCallsigns[currentCallsignIndex].icaoc;
    CallsignHint.innerHTML = ShuffledCallsigns[currentCallsignIndex].calls;
    CoutryHint.innerHTML = ShuffledCallsigns[currentCallsignIndex].contry;
    CoutryHint.style.backgroundColor = "white";
}

function check(){
    const Callsign = document.getElementById("Callsign");
    const ICAOcode = document.getElementById("ICAOcode");
    const currentCallsign = ShuffledCallsigns[currentCallsignIndex];

    if(mode === "basic"){
        if(currentCallsign.calls.toLowerCase() === Callsign.value.toLowerCase()){
            return true;
        }
        else{
            return false;
        }
    }
    else{
        if(currentCallsign.icaoc.toLowerCase() === ICAOcode.value.toLowerCase()){
            return true;
        }
        else{
            return false;
        }
    }
}

function checkCountry() {
    if(countryName.toLowerCase() === ShuffledCallsigns[currentCallsignIndex - 1].contry.toLowerCase()){
        return true;
    }
    else{
        return false;
    } 
}

function done(){
    currentCallsignIndex = 0;
    nextCallsignIndex = 1;
    errors = 0;
    errorstxt.innerHTML = errors;
    showCalls();
    filterAndShuffle();
    if(ErrorList.length < 1){
        alert('Congratulations! You have completed all the constraints.');
    }
    else{
        // Create a downloadable .txt file for the ErrorList
        const errorContent = ErrorList.join("\n");
        const blob = new Blob([errorContent], { type: 'text/plain' });
        const downloadLink = document.createElement('a');
        
        downloadLink.href = window.URL.createObjectURL(blob);
        downloadLink.download = 'ErrorList.txt'; // File name for download
        downloadLink.textContent = 'Download ErrorList';
        
        // Append the download link to the DOM so the user can click it
        document.body.appendChild(downloadLink);
        downloadLink.click();  // Automatically trigger the download
        document.body.removeChild(downloadLink);  // Clean up the link from DOM
        
        ErrorList.length = 0;
        errors = 0;
    }  
}

function deleteError(){
    errors -= 1;
    errorstxt.innerHTML = errors;
    //console.log("előtte: " + ErrorList.join("\n"))
    ErrorList.pop();
    //console.log("utána: " + ErrorList.join("\n"))
}

function refresh(){
    var selectFromValue = document.getElementById('SelectFrom').value;
    var selectToValue = document.getElementById('selectTo').value;

    if (selectFromValue === "" || selectToValue === "") {
        ShuffledCallsigns = shuffle(IcaoCallsigns);    
    } else{
        filterAndShuffle();
    }
    currentCallsignIndex = 0;
    nextCallsignIndex = 1;
    errors = 0;
    showCalls();
    clear();
}
